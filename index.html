<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Life Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <!-- Top Bar -->
    <header class="top-bar">
      <div class="logo">
        <span class="logo-icon">‚ú®</span>
        <span class="logo-text">LifeTracker</span>
      </div>
      <div class="top-actions">
        <button class="icon-btn" id="openSettingsBtn" title="Settings">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
          </svg>
        </button>
      </div>
    </header>

    <div class="app-layout">
      <!-- Sidebar Navigation -->
      <nav class="sidebar">
        <button class="nav-item active" data-view="dashboard">
          <span class="nav-icon">üìä</span>
          <span class="nav-label">Dashboard</span>
        </button>
        <button class="nav-item" data-view="tasks">
          <span class="nav-icon">‚òëÔ∏è</span>
          <span class="nav-label">To-Do List</span>
        </button>
        <button class="nav-item" data-view="habit">
          <span class="nav-icon">üéØ</span>
          <span class="nav-label">Habit</span>
        </button>
        <button class="nav-item" data-view="growth">
          <span class="nav-icon">üìà</span>
          <span class="nav-label">Growth</span>
        </button>
      </nav>

      <!-- Main Content Area -->
      <main class="content-area">
        
        <!-- DASHBOARD VIEW -->
        <div id="dashboard" class="view active">
          <div class="view-header">
            <h1>Dashboard</h1>
            <div style="display: flex; align-items: center; gap: 1rem;">
               <div class="current-date" id="dashDate"></div>
               <button class="btn-text" id="editDashboardBtn" style="color: var(--primary); font-size: 0.9rem;">‚úèÔ∏è Edit</button>
            </div>
          </div>
          <div class="dashboard-grid">
            <div class="dash-card" data-view="tasks">
              <h3>To-Do List</h3>
              <div class="big-stat" id="dashTaskStat">0/0</div>
              <p>Items completed today</p>
            </div>
            <div class="dash-card" data-view="habit">
              <h3>Habit Progress</h3>
              <div class="big-stat" id="dashGoalStat">0</div>
              <p>Habits in progress</p>
            </div>
            <div class="dash-card" data-view="growth">
              <h3>Latest Measurement</h3>
              <div class="big-stat" id="dashMeasureStat">--</div>
              <p id="dashMeasureLabel">No data</p>
            </div>
          </div>
        </div>

        <!-- TASKS VIEW -->
        <div id="tasks" class="view">
          <div class="view-header">
            <h1>To-Do List</h1>
            <button class="btn-primary" id="addTaskBtn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
              New Item
            </button>
          </div>
          <!-- Task Controls -->
          <div class="controls-bar">
             <div class="filter-tabs">
               <button class="filter-tab active" data-task-filter="all">All</button>
               <button class="filter-tab" data-task-filter="pending">To Do</button>
               <button class="filter-tab" data-task-filter="completed">Done</button>
             </div>
             <div class="controls-right">
                <select id="taskImportanceFilter" class="dropdown-sl">
                   <option value="all">All Importance</option>
                   <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
                   <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê</option>
                   <option value="3">‚≠ê‚≠ê‚≠ê</option>
                   <option value="2">‚≠ê‚≠ê</option>
                   <option value="1">‚≠ê</option>
                </select>
                <select id="taskCategoryFilter" class="dropdown-sl">
                  <option value="all">All Categories</option>
                </select>
                <select id="taskSortOrder" class="dropdown-sl">
                   <option value="newest">Newest First</option>
                   <option value="oldest">Oldest First</option>
                   <option value="dueDate">Due Date (Closest)</option>
                   <option value="importance">Importance (Highest)</option>
                </select>
             </div>
          </div>
          <div id="taskList" class="list-container"></div>
        </div>

        <!-- HABIT VIEW -->
        <div id="habit" class="view">
          <div class="view-header">
             <h1>Habit Tracker</h1>
             <button class="btn-primary" id="addGoalBtn">New Habit</button>
          </div>
          
          <div class="goals-controls">
             <div style="display: flex; align-items: center; gap: 1rem;">
                <div class="filter-tabs" id="goalFilterTabs">
                   <button class="f-tab active" data-goal-filter="all">All</button>
                   <button class="f-tab" data-goal-filter="daily">Daily</button>
                   <button class="f-tab" data-goal-filter="weekly">Weekly</button>
                   <button class="f-tab" data-goal-filter="monthly">Monthly</button>
                </div>
                <button class="icon-btn" id="toggleGoalCharts" title="Performance Charts" style="font-size: 1.2rem;">üìà</button>
                <div class="filter-tabs" id="habitTimeframeTabs" style="display: none; margin-left: 0.5rem;">
                   <button class="f-tab active" data-timeframe="7d">7D</button>
                   <button class="f-tab" data-timeframe="week">W</button>
                   <button class="f-tab" data-timeframe="month">M</button>
                   <button class="f-tab" data-timeframe="3m">3M</button>
                   <button class="f-tab" data-timeframe="year">Y</button>
                   <button class="f-tab" data-timeframe="all">All</button>
                </div>
             </div>
             <select id="goalCompletionFilter" class="dropdown-sl">
                <option value="all">All Progress</option>
                <option value="completed">Completed</option>
                <option value="pending">In Progress</option>
             </select>
          </div>

          <div id="goalList" class="goal-grid">
             <!-- Habit cards populated by JS -->
          </div>
          <div id="goalChartsContainer" class="goal-grid" style="display: none;">
             <!-- Performance charts populated by JS -->
          </div>
        </div>

        <!-- GROWTH VIEW -->
        <div id="growth" class="view">
          <div class="view-header">
             <h1>Growth & Metrics</h1>
             <div class="header-actions">
               <button class="btn-text" id="addNewMetricTypeBtn" style="color: var(--primary); margin-right: 0.5rem;">+ New Metric</button>
             </div>
          </div>
          
          <div class="growth-controls">
             <div class="timeframe-tabs">
               <button class="time-tab" data-range="7">1W</button>
               <button class="time-tab" data-range="30">1M</button>
               <button class="time-tab" data-range="90">3M</button>
               <button class="time-tab" data-range="365">1Y</button>
               <button class="time-tab active" data-range="all">All</button>
             </div>
          </div>

          <div id="metricsContainer" class="metrics-grid">
             <!-- Dynamically populated with metric cards -->
          </div>
        </div>

      </main>
    </div>

    <!-- MODALS -->

    <!-- Task Modal -->
    <div id="taskModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="taskModalTitle">New Task</h2>
          <button class="close-modal">&times;</button>
        </div>
        <form id="taskForm">
          <div class="form-group">
            <label>Title</label>
            <input type="text" id="taskName" required placeholder="Task name">
          </div>
          <div class="form-row">
             <div class="form-group">
                <label>Category</label>
                <select id="taskCategorySelect"></select>
             </div>
             <div id="newCategoryInputWrapper" class="form-group" style="display: none;">
                <label>Category Name</label>
                <div class="inline-input-btn">
                   <input type="text" id="newCategoryName" placeholder="e.g. Work">
                   <input type="color" id="newCategoryColor" value="#6366f1">
                </div>
             </div>
          </div>
          <div class="form-row">
            <div class="form-group">
               <label>Due Date</label>
               <input type="date" id="taskDueDate">
            </div>
            <div class="form-group">
               <label>Importance (1-5 ‚≠ê)</label>
                <select id="taskImportance">
                   <option value="1">‚≠ê</option>
                   <option value="2">‚≠ê‚≠ê</option>
                   <option value="3">‚≠ê‚≠ê‚≠ê</option>
                   <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê</option>
                   <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
                </select>
            </div>
            <div class="form-group">
               <label>Type</label>
                <select id="taskTypeSelect">
                   <option value="simple">Simple Checkbox</option>
                   <option value="quantitative">Quantitative</option>
                </select>
            </div>
          </div>
          <!-- Quant inputs -->
          <div id="taskQuantInputs" style="display:none;" class="sub-group">
             <div class="form-row">
                <div class="form-group">
                  <label>Target</label>
                  <input type="number" id="taskTarget" value="10">
                </div>
                <div class="form-group">
                   <label>Unit</label>
                   <input type="text" id="taskUnit" placeholder="pages">
                </div>
             </div>
          </div>
          <div class="form-group">
            <label>Description</label>
            <textarea id="taskDesc" rows="2"></textarea>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn-text close-modal">Cancel</button>
            <button type="submit" class="btn-primary">Save</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Goal Modal -->
    <div id="goalModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Set Habit Goal</h2>
          <button class="close-modal">&times;</button>
        </div>
        <form id="goalForm">
          <div class="form-group">
            <label>Goal Title</label>
            <input type="text" id="goalTitle" required placeholder="e.g. Drink Water">
          </div>
          
          <div class="form-row">
             <div class="form-group">
                <label>Frequency</label>
                <select id="goalFrequency">
                   <option value="daily">Daily</option>
                   <option value="weekly">Weekly</option>
                   <option value="monthly">Monthly</option>
                </select>
             </div>
             <div class="form-group">
                <label>Goal Type</label>
                <select id="goalType">
                   <option value="binary">Check-off (Binary)</option>
                   <option value="quantitative">Target Number (Quantitative)</option>
                </select>
             </div>
          </div>

          <div id="goalQuantFields" style="display: none;">
             <div class="form-row">
                <div class="form-group">
                   <label>Target Value</label>
                   <input type="number" id="goalTarget" placeholder="e.g. 2000">
                </div>
                <div class="form-group">
                   <label>Unit</label>
                   <input type="text" id="goalUnit" placeholder="e.g. ml">
                </div>
             </div>
          </div>

          <div class="form-group">
             <label>Description (Optional)</label>
             <textarea id="goalDesc" rows="2"></textarea>
          </div>

          <!-- History Management (Hidden by default, shown during edit) -->
          <div id="goalHistorySection" style="display:none;" class="sub-group">
             <label style="display:block; font-size: 0.85rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--text-muted);">History (Edit specific days)</label>
             <div id="goalHistoryList" class="history-list">
                <!-- History items populated by JS -->
             </div>
          </div>

          <div class="modal-actions">
             <button type="button" class="btn-text close-modal">Cancel</button>
             <button type="submit" class="btn-primary">Create Goal</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Metric Log Modal -->
    <div id="metricModal" class="modal">
       <div class="modal-content">
         <div class="modal-header">
            <h2>Log Entry</h2>
            <button class="close-modal">&times;</button>
         </div>
         <form id="metricForm">
            <div class="form-group">
               <label>Metric Type</label>
               <div class="row">
                 <select id="metricTypeInput" class="flex-grow">
                    <option value="weight">Weight</option>
                    <option value="steps">Daily Steps</option>
                    <option value="water">Water Intake</option>
                    <option value="sleep">Sleep Hours</option>
                    <option value="pushups">Pushups</option>
                    <option value="custom">Create New...</option>
                 </select>
               </div>
            </div>
            <!-- Custom Metric Creator -->
            <div id="newMetricInputs" style="display:none;" class="sub-group">
               <div class="form-group">
                 <label>Name</label>
                 <input type="text" id="newMetricName" placeholder="e.g. Pushups">
               </div>
               <div class="form-group">
                 <label>Unit</label>
                 <input type="text" id="newMetricUnit" placeholder="e.g. reps">
               </div>
               <div class="form-group">
                 <label>Goal / Target Value (Optional)</label>
                 <input type="number" id="newMetricTarget" step="0.01" placeholder="Add a red target line">
               </div>
            </div>

            <div class="form-row" id="metricDataFields">
               <div class="form-group">
                  <label>Value</label>
                  <input type="number" id="metricValue" step="0.01">
               </div>
               <div class="form-group">
                  <label>Date</label>
                  <input type="date" id="metricDate" required>
               </div>
            </div>
            <div class="modal-actions">
               <button type="button" class="btn-text close-modal">Cancel</button>
               <button type="submit" class="btn-primary">Log</button>
            </div>
         </form>
       </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
       <div class="modal-content">
          <div class="modal-header">
             <h2>Settings</h2>
             <button class="close-modal">&times;</button>
          </div>
          <div class="settings-body">
             <!-- Appearance -->
             <div class="setting-group">
                <h3>Appearance</h3>
                <div class="setting-row">
                   <span>Dark Mode</span>
                   <label class="switch">
                      <input type="checkbox" id="themeToggle">
                      <span class="slider round"></span>
                   </label>
                </div>
                <div class="setting-row">
                   <span>Accent Color</span>
                   <div class="color-options">
                      <button class="color-btn" style="background:#6366f1" data-color="#6366f1"></button>
                      <button class="color-btn" style="background:#10b981" data-color="#10b981"></button>
                      <button class="color-btn" style="background:#f59e0b" data-color="#f59e0b"></button>
                      <button class="color-btn" style="background:#ec4899" data-color="#ec4899"></button>
                      <button class="color-btn" style="background:#3b82f6" data-color="#3b82f6"></button>
                   </div>
                </div>
             </div>
             
             <!-- Preferences -->
             <div class="setting-group">
                <h3>Preferences</h3>
                <p class="setting-desc">Global units are set to <b>Euro (‚Ç¨)</b> and <b>Kilograms (kg)</b>.</p>
             </div>
          </div>
       </div>
    </div>

    <!-- Dashboard Widget Modal -->
    <div id="dashWidgetModal" class="modal">
       <div class="modal-content">
          <div class="modal-header">
             <h2 id="dashWidgetModalTitle">Widget Settings</h2>
             <button class="close-modal">&times;</button>
          </div>
          <form id="dashWidgetForm">
             <input type="hidden" id="dashWidgetId">
             
             <!-- Task Widget Settings -->
             <div id="dashSettingsTasks" class="widget-settings-group" style="display:none;">
                <div class="form-group">
                   <label>Display Type</label>
                   <select id="dashTaskType">
                      <option value="today">Completed Today</option>
                      <option value="pending">Remaining To-Do</option>
                   </select>
                </div>
             </div>

             <!-- Habit Widget Settings -->
             <div id="dashSettingsHabit" class="widget-settings-group" style="display:none;">
                <div class="form-group">
                   <label>Display Type</label>
                   <select id="dashHabitType">
                      <option value="count">Active Habits Count</option>
                      <option value="completed">Completed Count</option>
                      <option value="percentage">Average Consistency</option>
                   </select>
                </div>
             </div>

             <!-- Growth Widget Settings -->
             <div id="dashSettingsGrowth" class="widget-settings-group" style="display:none;">
                <div class="form-group">
                   <label>Select Metrics & Stats to Display</label>
                   <div id="dashGrowthMetricList" style="display:flex; flex-direction:column; gap:1rem; max-height:300px; overflow-y:auto; padding-right:0.5rem;">
                      <!-- Populated by JS: Each metric gets a checkbox and nested stat checkboxes -->
                   </div>
                </div>
             </div>

             <div class="modal-actions">
                <button type="button" class="btn-text close-modal">Cancel</button>
                <button type="submit" class="btn-primary">Save Settings</button>
             </div>
          </form>
       </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
